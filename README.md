# Power Cache Office
共有フォルダのOfficeファイルが、重くてなかなか開けなかった経験はありませんか？  
やっとの思いで開いたファイルが、使用中で更新できなかったことは？  
検索に時間がかかり、探しているファイルが見つからなかったことは？  
  
「Power Cache Office」はこれらの問題を解決します。
* リモートのOfficeファイルを開くと、自動でローカルにコピーを作成します。
    * ローカルPCにあるファイルとして、軽快に操作することができます。
        * もちろん検索も高速に実行できます。
    * リモートのファイルをロックしないため、他の人との共同作業を邪魔しません。
* ローカルのコピーを更新すると、自動でリモートへアップロードします。
    * リモートのタイムスタンプが変わっていた場合、差分を確認してからアップロードすることもできます。
* その他、Officeファイルの操作全般をサポートします。
    * ファイル編集時、自動でバックアップを取得します。
    * 最新開いたファイルを一覧化し、すばやく開きます。
        * ファイルをピン留めして、簡易的なアプリランチャーとしても使えます。
    * クリップボードのパスをホットキーから開きます。

## 画面構成
以下が「Power Cache Office」の画面構成です。  
各機能の使い方を説明していきます。  
![picture 0](images/8af06b861739dec3815c14fb133d4ff1de4ca30f55fbffd9df43c4185de4a61f.png)  

### Dark / Light
ダークモード・ライトモードを切り替えます。

### Update
本アプリの更新を確認します。

### 関連付け
チェックを入れた拡張子が「Power Cache Office」で開くように関連付けを行います。  
特に理由がなければ、すべてチェックを入れてください。  
  
チェックを入れるとOfficeファイルを開く際「常に使う」アプリに「Power Cache Office」が選択可能になります。  
常に使うアプリに設定し、アイコンが変更されれば完了です。  
うまくいかない場合は、PCを一度再起動してみてください。  
![picture 1](images/8f19ee306db185dd57d408aac6f2ca82b9c4793caac30b4a2ca09ae12f5c4aa0.png)  

### キャッシュ対象フォルダ
キャッシュ作成する（ローカルPCにコピーを作成する）フォルダを指定します。  
共有フォルダや、外付けハードディスクのパスを指定してください。  
  
テキストボックスにパスを入力し「＋」ボタンを押すと追加されます。  
追加したパスを削除する場合、選択して「Delete」キーを押すか、右クリックして「削除」を押してください。

### ホットキー
以下の機能をホットキーに登録します。  

* クリップボードのパスを開く
    * クリップボードにパスがコピーされている場合、そのパスを開きます。
* 最近開いたファイルを表示
    * 本アプリで最近開いたファイルを表示します。
        * 表示されたファイルや親フォルダを開いたり、パスをコピーすることができます。  
    * 最近開いたファイルや、エクスプローラーのファイルをピン留めしておくこともできます。
        * ピン留めするには、ピン留め欄にドラッグアンドドロップしてください。

ホットキーを変更するには、テキストボックス上で登録したいキーを押してください。

### スタートアップに登録する
チェックを入れると、PC起動時に本アプリを起動します。

### 自動でバックアップを取得する
チェックを入れると、本アプリからファイルを開く際に（未作成であれば）ファイルのコピーを取得します。  
コピーが未作成かどうかは、タイムスタンプで判定されます。

### 再起動時にキャッシュを削除する
チェックを入れると、本アプリの再起動時にキャッシュ（ローカルのコピー）をすべて削除します。  
検索等はできなくなりますが、ローカルにファイルを残したくない場合、チェックを入れてください。

### 最近開いたファイルを表示
ホットキーの「最近開いたファイルを表示」と同じ機能です。

### インデックスを再作成
キャッシュとリモートの関係を再作成します。  
リモートのOfficeファイルが、うまく開けなくなった場合に実施してください。

### バックアップを削除
バックアップ（開いたファイルのコピー）をすべて削除します。  
PCの容量が不足した場合等に実施してください。

### キャッシュを削除
キャッシュをすべて削除します。  
インデックスを再作成しても、リモートのOfficeファイルがうまく開けない場合や、PCの容量が不足した場合等に実施してください。

### バックアップを検索
キーワードを入力してボタンを押すと、バックアップを対象に検索を実施します。

### キャッシュを検索
キーワードを入力してボタンを押すと、キャッシュを対象に検索を実施します。

### キャッシュを事前作成
対象フォルダを入力してボタンを押すと、フォルダにあるOfficeファイルをローカルにコピーします。  
以下の2点に注意して実施してください。
* 処理に時間がかかる可能性があります。
* 大量のファイルをキャッシュすると、PCの容量が不足する可能性があります。

## インストール
[PowerCacheOfficeSetup.msi](https://github.com/p1tchbend-tool/PowerCacheOffice/tree/master/App) を実行してインストールします。

## セットアップ
アプリを実行するとタスクトレイに常駐します。  
タスクトレイのアイコンをクリックして画面を開き、各種設定を実施してください。  
設定後は最小化すると、タスクトレイに常駐して動作し続けます。

### 差分比較ツール
自分がファイルを編集中に、他の人がそのファイルを更新した場合、差分を「ツールで確認する」ことができます。  
なお、単に「開いて確認する」ことも可能なので、ツールを使わずOfficeの「ファイルの比較」機能も利用できます。  
![picture 2](images/E08F5C40-1AA8-42F1-A4C2-4D838777FAD1.png)  
  
ここでは例として、差分比較ツールに「WinMerge」を使う方法を解説します。  
1. [公式サイト](https://winmerge.org/downloads/?lang=ja)から、WinMergeをインストールします。  
1. WinMergeを起動して「プラグイン」を「自動展開」に変更します。  
![picture 3](images/7589CB7B-A159-40D0-B9FA-4B4895FBB229.png)  
1. 本アプリを再起動します。  
  
差分比較ツールは[方眼Diff](https://hogandiff.hotchpotch.xyz)等、WinMerge以外を使うこともできます。  
1. 本アプリと同じフォルダにある「appSettings.json」をメモ帳等で開きます。
1. ExcelDiffToolPath、WordDiffToolPath、PowerPointDiffToolPathを適切なパスに書き換えます。
1. 本アプリを再起動します。

### Officeアプリの場所
本アプリは以下どちらかにExcel、Word、PowerPointがインストールされている前提で動作します。
* C:\Program Files\Microsoft Office\root\Office16
* C:\Program Files (x86)\Microsoft Office\root\Office16
  
それ以外の場所にインストールされている場合、Excel、Word、PowerPointの場所を指定します。  
[LibreOffice](https://ja.libreoffice.org)等を使用している場合も、同様に場所を指定してください。
1. 本アプリと同じフォルダにある「appSettings.json」をメモ帳等で開きます。
1. ExcelPath、WordPath、PowerPointPathを適切なパスに書き換えます。
1. 本アプリを再起動します。

## アンインストール
Windowsの設定からアンインストールします。  
また以下のフォルダを必要に応じて削除します。  
  
%LOCALAPPDATA%\PowerCacheOffice  
  
上記フォルダにはキャッシュ、バックアップ、及び本アプリの設定が保存されています。  
アンインストール後に再インストールする場合は、削除しないでください。

## ライセンス
本アプリは、[MIT ライセンス](https://licenses.opensource.jp/MIT/MIT.html)で提供されます。

## 連絡先
本アプリに関するご連絡は、[こちら](<mailto:p1tchbend.tool@gmail.com>)までお願いいたします。
